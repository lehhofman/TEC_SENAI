<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="style.css">

</head>

<body>

    <h1>ATIVIDADE BCD :</h1>

    <h3> 1 - Crie uma consulta que mostre somente os nomes de todos os clientes:</h3>
    <p>SELECT nome FROM cliente;</p>

    <h3> 2 - Crie uma consulta que agrupe as estregas e mostre quantas cada motorista fez:</h3>
    <p>SELECT motorista, COUNT(motorista) FROM entrega GROUP BY motorista;</p>
    <p>SELECT f.nome, COUNT(e.motorista) FROM entrega e INNER JOIN funcionario f ON f.idFuncionario = e.motorista GROUP BY motorista;</p>
    <p>SELECT f.nome AS nomeMotorista, COUNT(*) AS totalEntregas FROM entrega e JOIN funcionario f ON e.motorista = f.idFuncionario GROUP BY e.motorista, f.nome;</p>

    <h3> 3 - Salve a consulta anterior em um relatório chamado 'entregas por motorista':</h3>
    <p>CREATE VIEW entregas_por_motorista as SELECT f.nome AS nomeMotorista, COUNT(*) AS totalEntregas FROM entrega e JOIN funcionario f ON e.motorista = f.idFuncionario GROUP BY e.motorista, f.nome;</p>
    <p>CREATE VIEW entregas_por_motorista as SELECT motorista, COUNT(motorista) FROM entrega GROUP BY motorista;</p>
    <p>CREATE VIEW entregas_por_motorista as SELECT f.nome, COUNT(e.motorista) FROM entrega e INNER JOIN funcionario f ON f.idFuncionario = e.motorista GROUP BY motorista;</p>

    <h3> 4 - Crie uma consulta que mostre todas as rotas ordenadas por distância:</h3>
    <p>SELECT idrota, distancia FROM rota ORDER BY distancia;</p>

    <h3> 5 - Crie uma consulta que mostre os funcionários ordenados por nome:</h3>
    <p>SELECT idFuncionario, nome FROM funcionario ORDER BY nome;</p>

    <h3> 6 - Crie uma consulta que mostre qual veículo fez mais entregas e o total de entregas que ele fez:</h3>
    <p>SELECT placa, COUNT(idEntrega) FROM entrega GROUP BY placa;</p>
    <p>SELECT placa, COUNT(idEntrega) AS 'entregas' FROM entrega GROUP BY placa ORDER BY COUNT(idEntrega) DESC;</p>
    <p>SELECT placa, COUNT(idEntrega) AS 'entregas' FROM entrega GROUP BY placa ORDER BY COUNT(idEntrega) DESC LIMIT 1;</p>
    <p>SELECT e.placa, v.modelo, COUNT(e.idEntrega) AS 'entregas' FROM entrega e INNER JOIN veiculo v ON e.placa = v.placa GROUP BY e.placa ORDER BY COUNT(e.idEntrega) DESC LIMIT 1;</p>

    <h3> 7 - Crie um relatório que mostre todas as entregas com os nomes dos motoristas, modelos dos veículos, salve como 'relatorio_de_entregas_01':</h3>
    <p>SELECT f.nome AS 'motoristas', v.modelo, e.*FROM entrega e INNER JOIN funcionario f ON e.motorista = f.idFuncionario INNER JOIN veiculo v ON e.placa = v.placa;</p>
    <p>CREATE VIEW relatorio_de_entregas_01 AS SELECT f.nome AS 'motoristas', v.modelo, e.*FROM entrega e INNER JOIN funcionario f ON e.motorista = f.idFuncionario INNER JOIN veiculo v ON e.placa = v.placa;</p>


    <h3> 8 - Crie um relatório que mostre todas as entregas com os nomes dos motoristas, modelos dos veículos e o valor total da entrega, salve como 'relatorio_de_entregas_02':</h3>
    <p>SELECT f.nome, v.modelo, e.*, sum(p.valor) AS total FROM entrega e INNER JOIN funcionario f ON e.motorista = f.idFuncionario INNER JOIN veiculo v ON e.placa = v.placa INNER JOIN pedido p ON e.idEntrega = p.idEntrega GROUP BY e.idEntrega;</p>
    <p>CREATE VIEW relatorio_de_entregas_02 AS SELECT f.nome, v.modelo, e.*, SUM(p.valor) AS total FROM entrega e INNER JOIN funcionario f ON e.motorista = f.idFuncionario INNER JOIN veiculo v ON e.placa = v.placINNER JOIN pedido p ON e.idEntrega = p.idEntrega GROUP BY e.idEntrega;</p>

</body>

</html>